params {
    outdir = "${projectDir}/output"
    t = 4
    pod5=null
    no_mod=false
    sample_id="reads"
    ref = null
    help = false
}

process {
    withLbel:dorado {
        container="ontresearch/dorado:latest"
    }
    withLabel:pod5 {
        container="chrisamiller/pod5-tools"
    }
    withLabel:fastp {
        container="nanozoo/fastp:latest"
    }
    withLabel:minimap {
        container="ghcr.io/bwbioinfo/minimap2-docker-cwl:latest"
    }
    withLabel:samtools {
        container="ghcr.io/bwbioinfo/samtools-docker-cwl:latest"
    }
    withName:multiqc {
        container="multiqc/multiqc:latest"
    }
}

profiles {
    standard {
        docker.enabled=true
        process."withLabel:gpu".containerOptions = "--gpus all"
        params.model=sup
        params.m_bases="5mCG_5hmCG"
    }
    no_gpu {
        docker.enabled=true
        params.model=sup
        params.m_bases="5mCG_5hmCG"
    }
    drac {
        params {
            model=project/ctb-noncodo/Platform/references/dorado_models/dna_r10.4.1_e8.2_400bps_sup@v4.3.0
            slurm_account=null
            m_bases=project/ctb-noncodo/Platform/references/dorado_models/dna_r10.4.1_e8.2_400bps_sup@v4.3.0_5mC_5hmC@v1
        }
        apptainer {
            enabled=true
            autoMounts=true
            libraryDir = "/project/ctb-noncodo/Platform/references/apptainer/images"
            cacheDir = "/project/ctb-noncodo/Platform/references/apptainer/cache"
        }
        process {
            clusterOptions = "--account=params.slurm_account"
            withLabel:gpu {
                containerOptions = "--nv" 
                clusterOptions = "--gpus-per-node=4 --cpus-per-task=16 --mem 100G --time=2-06:00:00"
            }
            withLabel:pod5 {
                clusterOptions = "--cpus-per-task=6 --mem 12G --time=3:00:00"
            }
        }
    }
}